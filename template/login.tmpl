<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>Log in</title>

    <meta name="description" content="Source code generated using layoutit.com">
    <meta name="author" content="LayoutIt!">

    <link href="/static/css/bootstrap.min.css" rel="stylesheet">
    <link href="/static/css/style.css" rel="stylesheet">
  </head>
  <body>

    <div class="container-fluid">
	<div class="row">
		<div class="col-md-12">
		</div>
	</div>
	<div class="row">
		<div class="col-md-12">
			<div class="row">
				<div class="col-md-4">
				</div>
				<div class="col-md-4">
					<h3 class="text-center">
						Login User
					</h3>
				</div>
				<div class="col-md-4">
				</div>
			</div>
		</div>
	</div>
	<div class="row">
		<div class="col-md-12">
			<div class="row">
				<div class="col-md-4">
				</div>
				<div class="col-md-4">
					 <span id="result-tip" class="badge badge-danger">
					 	密码输入错误
					 </span>
					<form id="user-info" method="POST" role="form">
						<div class="form-group">

							<label for="exampleInputPassword1">
								Username
							</label>
							<input name="username" class="form-control" id="exampleInputEmail1" type="text">
						</div>
						<div class="form-group">
							 
							<label for="exampleInputPassword1">
								Password
							</label>
							<input name="password" class="form-control" id="exampleInputPassword1" type="password">
						</div>
						<div class="form-group">

							<p class="help-block">
								Example block-level help text here.
							</p>
						</div>
						<div class="checkbox">

							<label>
								<input type="checkbox">
							</label>
						</div>
						
					</form>
					<button data-toggle="modal"  data-target="#successModal" onclick="gowe()" class="btn btn-primary">
							Submit
						</button>
				</div>
				<div class="col-md-4">
				</div>
			</div>
		</div>
	</div>
</div>

	<script>


const aoerjia =  `

	ₘₙⁿ
	▏n
	█▏　､⺍
	█▏ ⺰ʷʷｨ
	█◣▄██◣
	◥██████▋
	　◥████ █▎
	　　███▉ █▎
	　◢████◣⌠ₘ℩
	　　██◥█◣\≫
	　　██　◥█◣
	　　█▉　　█▊
	　　█▊　　█▊
	　　█▊　　█▋
	　　 █▏　　█▙
`


		function gowe(){

			var formData = $("#user-info").serializeArray();
			console.log(JSON.stringify(transformToJson(formData)));
			$.ajax({
				url:"/login",
				contentType:"application/json;charset=UTF-8",
				type:"POST",
				data:JSON.stringify(transformToJson(formData)),
				async:true,
				success: function(res){
					console.log(res.success)
					if(!res.success){
						console.log(res)
						console.log(res.error)
						alert(aoerjia)
						alert(res.error)
						let reusltTip = document.getElementById("result-tip")
						reusltTip.innerHTML = "登录失败_(:з」∠)_不要停下来啊！"
					} else {
						let reusltTip = document.getElementById("result-tip")
						reusltTip.innerHTML = "登录陈宫_(:з」∠)_"
						
					}
				},
				dataType:"json"
			})
		}

		function transformToJson(formData){
			var obj={}
			for (var i in formData) {
				/*[{"name":"user","value":"hpc"},{"name":"pwd","value":"123"},{"name":"sex","value":"M"},{"name":"age","value":"100"},{"name":"phone","value":"13011112222"},{"name":"email","value":"xxx@xxx.com"}]
				*/
				//下标为的i的name做为json对象的key，下标为的i的value做为json对象的value
				obj[formData[i].name]=formData[i]['value'];
			}
			return obj;
    	}

	</script>

    <script src="/static/js/jquery.min.js"></script>
    <script src="/static/js/bootstrap.min.js"></script>
    <script src="/static/js/scripts.js"></script>
  </body>
</html>